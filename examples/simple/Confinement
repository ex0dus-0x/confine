sample:
    name: Simple Command Execution
    description: Traces a simple command executing in a confine container

filter:
    logpath: test.log
    rules:
        - name: Open warn rule
          syscall: openat
          action: WARN

        - name: Close log rule
          syscall: close
          action: LOG

        - name: Exit block rule
          syscall: exit_group
          action: BLOCK

setup:
    - name: Build
      trace: false
      description: Build smoke screen test
      command: ["gcc", "example.c"]

execution:
    - name: Check directory
      trace: true
      description: Traces ls
      command: ["/bin/ls"]

    - name: Run sample
      trace: true
      description: Run and trace the sample
      command: ["./a.out"]
